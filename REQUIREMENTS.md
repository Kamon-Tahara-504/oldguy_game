# おっさんゲーム 要件定義書

## 1. プロジェクト概要

### 1.1 ゲームのコンセプト
スイカゲームのルールをベースに、果物の代わりに人間の顔面を使用した落下合体型パズルゲーム。

### 1.2 目標
- Phaser 3 + TypeScript + Vite を使用した2D Webゲーム
- GitHub Pagesでデプロイ可能
- PC画面専用（デスクトップブラウザ対応）

---

## 2. ゲームルール

### 2.1 基本ルール
- [ ] 画面上部から顔面が落下してくる
- [ ] 同じ種類の顔面2つが接触すると、次のレベルの顔面に合体する
- [ ] 合体によりスコアが加算される
- [ ] 画面外（上部の危険ラインを超える）に顔面があるとゲームオーバー
- [ ] 時間制限はあるか？□ なし □ あり（___分）

### 2.2 顔面の種類と合体チェーン

合体の順序（要確認）：
1. **赤ちゃんの顔** → 2つで合体 → **少年の顔**
2. **少年の顔** → 2つで合体 → **青年の顔**
3. **青年の顔** → 2つで合体 → **大人の顔**
4. **大人の顔** → 2つで合体 → **中年の顔**
5. **中年の顔** → 2つで合体 → **高齢の顔**
6. **高齢の顔** + **高齢の顔** → **昇天エフェクト**（上に登っていくアニメーション）で消滅

### 2.3 合体ルールの詳細
- [ ] 同じ種類のみ合体可能か
- [ ] 異なる種類は合体できない（バウンスする？）
- [ ] 通常の合体時のエフェクト（アニメーション、音声）
- [ ] **高齢の顔同士の合体**: 昇天エフェクト（上に登っていくアニメーション）で消滅し、高得点を獲得
- [ ] 合体時のスコア加算方法

---

## 3. 操作方法

### 3.1 入力デバイス
- [ ] PC: マウス操作のみ

### 3.2 操作内容
- [ ] **落下前の位置決定**: マウスでX座標を決める（画面上部でマウスに追従）
- [ ] **落下開始**: クリックまたはマウスボタンを離すと落下開始
- [ ] **落下中は操作不可**: 一度落下を開始したら、位置の変更はできない
- [ ] スイカゲームと同じ操作感

---

## 4. ゲーム画面構成

### 4.1 画面レイアウト
- **ゲームエリア**: 顔面が落下・合体するメインエリア
- **スコア表示**: 現在のスコア
- **次の顔面プレビュー**: 次に落ちてくる顔面の表示
- **危険ライン**: ゲームオーバー判定ライン（視覚的表示）
- **リトライボタン**: ゲームオーバー時の再開ボタン

### 4.2 UI要素
- [ ] スコア表示（位置、フォント、サイズ）
- [ ] ハイスコア表示
- [ ] ゲームオーバー画面
- [ ] タイトル画面
- [ ] ポーズ機能

---

## 5. 物理挙動

### 5.1 落下システム
- [ ] 重力の強さ
- [ ] 落下速度

### 5.2 衝突判定
- [ ] 円形の当たり判定
- [ ] 他の顔面との衝突（バウンス、停止）
- [ ] 壁との衝突
- [ ] 地面との衝突（下に落ちるか、床で止まるか）

### 5.3 合体条件
- [ ] 接触距離の閾値
- [ ] 速度による影響はあるか
- [ ] 合体までの時間差

---

## 6. スコアシステム

**重要**: スイカゲームの得点システムを完全に踏襲する

### 6.1 スコア加算方法
- [ ] **スイカゲームの得点システムをそのまま採用**
- [ ] 各レベルごとに決められた基本スコア（レベルが高いほど高得点）
- [ ] コンボボーナス（連続合体による追加ボーナス）
- [ ] **高齢の顔同士の合体（昇天）**: スイカゲームの最高レベル（スイカ）と同じ得点

### 6.2 スコア計算式（スイカゲーム準拠）

**スイカゲームの実際の得点システム（11段階）:**
1. さくらんぼ: 2点
2. いちご: 4点
3. ぶどう: 6点
4. デコポン: 8点
5. みかん: 10点
6. りんご: 12点
7. なし: 14点
8. もも: 16点
9. パイナップル: 18点
10. メロン: 20点
11. スイカ: 22点

**おっさんゲームでの得点マッピング（6段階） - 案2採用:**

- レベル1（赤ちゃんの顔）: **2点**（さくらんぼ相当）
- レベル2（少年の顔）: **6点**（ぶどう相当）
- レベル3（青年の顔）: **10点**（みかん相当）
- レベル4（大人の顔）: **14点**（なし相当）
- レベル5（中年の顔）: **18点**（パイナップル相当）
- レベル6（高齢の顔）: **20点**（メロン相当）
- **高齢の顔昇天**: **22点**（スイカ相当）

※ コンボボーナスについては、スイカゲームの仕様を確認して実装する

---

## 7. アセット要件

### 7.1 画像アセット
- [ ] 赤ちゃんの顔（サイズ: ___px）
- [ ] 少年の顔（サイズ: ___px）
- [ ] 青年の顔（サイズ: ___px）
- [ ] 大人の顔（サイズ: ___px）
- [ ] 中年の顔（サイズ: ___px）
- [ ] 高齢の顔（サイズ: ___px）
- [ ] 背景画像
- [ ] UI要素（ボタン、フレームなど）

### 7.2 音声アセット
- [ ] BGM（ループ再生）
- [ ] 通常の合体時の効果音
- [ ] **高齢の顔昇天時の効果音**（特別な音）
- [ ] ゲームオーバー時の効果音
- [ ] UI操作時の効果音（クリック音など）

### 7.3 アセットのサイズ方針
- [ ] 各顔面のサイズはレベルごとに異なるか（大きくなる？）
- [ ] すべて同じサイズか

---

## 8. 技術要件

### 8.1 画面サイズ
- **開発時の画面サイズ**: 800 × 600px（固定）
- **レスポンシブ対応**: 不要（PC画面専用）
- **アスペクト比固定**: あり

### 8.2 パフォーマンス
- [ ] 60FPSでの動作を目標
- [ ] 大量のオブジェクト処理の最適化

### 8.3 ブラウザ対応
- [ ] Chrome（最新版、デスクトップ）
- [ ] Safari（最新版、デスクトップ）
- [ ] Firefox（最新版、デスクトップ）
- モバイルブラウザは対象外

---

## 9. ゲームシーン構成

### 9.1 シーン一覧
1. **TitleScene**: タイトル画面
2. **GameScene**: メインゲーム画面
3. **GameOverScene**: ゲームオーバー画面
4. **PauseScene**: ポーズ画面（必要な場合）

---

## 10. 未決定事項・質問

1. 顔面のデザイン（イラスト、写真、3D風など）はどうするか？
2. ~~得点マッピングの採用案~~ → **決定: 案2を採用**（6.2を参照）
3. コンボボーナスの計算式の詳細（スイカゲーム準拠、要確認）
4. ローカルストレージでハイスコアを保存するか
5. 背景のデザイン（単色、グラデーション、画像など）
6. 昇天エフェクトの詳細（アニメーション速度、パーティクルエフェクトなど）
7. 落下速度は固定か

---

## 11. 開発フェーズ（案）

### Phase 1: 基本実装
- [ ] 基本的な落下システム
- [ ] 衝突判定
- [ ] 合体システム
- [ ] ゲームオーバー判定

### Phase 2: UI・UX
- [ ] スコア表示
- [ ] ゲームオーバー画面
- [ ] タイトル画面
- [ ] 操作感の調整

### Phase 3: アセット・エフェクト
- [ ] 画像アセットの実装
- [ ] 音声の実装
- [ ] 通常の合体エフェクト
- [ ] **高齢の顔昇天エフェクト**（上に登っていくアニメーション）
- [ ] 視覚的な改善

### Phase 4: 仕上げ
- [ ] バランス調整
- [ ] バグ修正
- [ ] パフォーマンス最適化
- [ ] デプロイ準備

